<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Values and Priorities Survey</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #eff6ff 0%, #ffffff 50%, #faf5ff 100%);
            min-height: 100vh;
            padding: 2rem;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            margin-bottom: 3rem;
        }

        h1 {
            font-size: 3rem;
            color: #1f2937;
            margin-bottom: 1rem;
        }

        .subtitle {
            font-size: 1.25rem;
            color: #4b5563;
            line-height: 1.6;
            max-width: 800px;
            margin: 0 auto;
        }

        .instruction {
            font-size: 1rem;
            color: #6b7280;
            margin-top: 0.5rem;
            display: block;
        }

        .form-section {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            margin-bottom: 3rem;
        }

        .form-section h2 {
            font-size: 1.5rem;
            color: #1f2937;
            margin-bottom: 1.5rem;
        }

        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
        }

        .form-group {
            display: flex;
            flex-direction: column;
        }

        .form-group.full-width {
            grid-column: 1 / -1;
        }

        .form-label {
            font-size: 0.875rem;
            font-weight: 600;
            color: #374151;
            margin-bottom: 0.5rem;
        }

        .form-label .required {
            color: #ef4444;
        }

        .form-input,
        .form-textarea {
            padding: 0.75rem;
            border: 2px solid #e5e7eb;
            border-radius: 0.5rem;
            font-size: 1rem;
            transition: all 0.3s;
        }

        .form-input:focus,
        .form-textarea:focus {
            outline: none;
            border-color: #3b82f6;
            box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);
        }

        .form-textarea {
            resize: vertical;
            min-height: 100px;
            font-family: inherit;
        }

        .plots-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(500px, 1fr));
            gap: 3rem;
            margin-bottom: 3rem;
        }

        .plot-card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            padding: 2rem;
            transition: transform 0.3s;
        }

        .plot-card:hover {
            transform: scale(1.01);
        }

        .plot-title {
            font-size: 1.5rem;
            font-weight: bold;
            color: #1f2937;
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .svg-container {
            display: flex;
            justify-content: center;
            margin-bottom: 1.5rem;
        }

        svg {
            cursor: pointer;
            transition: opacity 0.3s;
        }

        svg.completed {
            opacity: 0.75;
            cursor: not-allowed;
        }

        .values-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 1.5rem;
        }

        .value-box {
            padding: 0.75rem;
            border-radius: 0.5rem;
            text-align: center;
        }

        .value-box.sustainable {
            background: #dbeafe;
            border: 2px solid #93c5fd;
        }

        .value-box.health {
            background: #d1fae5;
            border: 2px solid #6ee7b7;
        }

        .value-box.environmental {
            background: #e9d5ff;
            border: 2px solid #c084fc;
        }

        .value-label {
            font-size: 0.75rem;
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .sustainable .value-label { color: #1e40af; }
        .health .value-label { color: #047857; }
        .environmental .value-label { color: #7c3aed; }

        .value-number {
            font-size: 1.25rem;
            font-weight: bold;
        }

        .sustainable .value-number { color: #1e3a8a; }
        .health .value-number { color: #065f46; }
        .environmental .value-number { color: #6b21a8; }

        .lock-button {
            width: 100%;
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 0.5rem;
            font-size: 1rem;
            font-weight: 600;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            margin-top: 1rem;
        }

        .lock-button.current {
            background: #2563eb;
        }

        .lock-button.current:hover:not(:disabled) {
            background: #1d4ed8;
            box-shadow: 0 4px 12px rgba(37, 99, 235, 0.4);
        }

        .lock-button.future {
            background: #7c3aed;
        }

        .lock-button.future:hover:not(:disabled) {
            background: #6d28d9;
            box-shadow: 0 4px 12px rgba(124, 58, 237, 0.4);
        }

        .lock-button:disabled {
            background: #9ca3af;
            cursor: not-allowed;
        }

        .submit-section {
            text-align: center;
            margin-bottom: 2rem;
        }

        .submit-button {
            padding: 1rem 3rem;
            border: none;
            border-radius: 0.75rem;
            font-size: 1.125rem;
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, #2563eb 0%, #7c3aed 100%);
            cursor: pointer;
            transition: all 0.3s;
        }

        .submit-button:hover:not(:disabled) {
            background: linear-gradient(135deg, #1d4ed8 0%, #6d28d9 100%);
            box-shadow: 0 8px 20px rgba(37, 99, 235, 0.4);
            transform: scale(1.05);
        }

        .submit-button:disabled {
            background: #d1d5db;
            cursor: not-allowed;
            transform: none;
        }

        .error-message {
            color: #ef4444;
            font-size: 0.875rem;
            margin-top: 0.5rem;
            display: none;
        }

        .error-message.show {
            display: block;
        }

        .thank-you-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .thank-you-overlay.show {
            display: flex;
        }

        .thank-you-box {
            background: white;
            border-radius: 1rem;
            padding: 3rem;
            text-align: center;
            box-shadow: 0 20px 50px rgba(0, 0, 0, 0.3);
        }

        .thank-you-emoji {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .thank-you-title {
            font-size: 2rem;
            font-weight: bold;
            color: #1f2937;
            margin-bottom: 0.5rem;
        }

        .thank-you-text {
            color: #6b7280;
        }

        .loading-spinner {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        footer {
            text-align: center;
            margin-top: 3rem;
            color: #6b7280;
            font-size: 0.875rem;
        }

        footer p {
            margin: 0.25rem 0;
        }

        @keyframes ping {
            75%, 100% {
                transform: scale(2);
                opacity: 0;
            }
        }

        .ping {
            animation: ping 1s cubic-bezier(0, 0, 0.2, 1) infinite;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 2rem;
            }

            .plots-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Values and Priorities Survey</h1>
            <p class="subtitle">
                How do you prioritize these three areas today versus in 2075?<br>
                <span class="instruction">Please fill in your information below, then drag the red points inside each triangle.</span>
            </p>
        </header>

        <!-- User Information Form -->
        <div class="form-section">
            <h2>Your Information</h2>
            <div class="form-grid">
                <div class="form-group">
                    <label class="form-label">Name <span class="required">*</span></label>
                    <input type="text" id="userName" class="form-input" placeholder="Enter your name" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Email <span class="required">*</span></label>
                    <input type="email" id="userEmail" class="form-input" placeholder="your.email@example.com" required>
                </div>
                <div class="form-group full-width">
                    <label class="form-label">Comments (Optional)</label>
                    <textarea id="userComments" class="form-textarea" placeholder="Share any thoughts or context about your priorities..."></textarea>
                </div>
            </div>
            <div class="error-message" id="formError">Please fill in all required fields (Name and Email)</div>
        </div>

        <div class="plots-grid">
            <!-- Current Year Plot -->
            <div class="plot-card">
                <h3 class="plot-title">Present Day (2025)</h3>
                <div class="svg-container">
                    <svg id="currentPlot" width="560" height="506"></svg>
                </div>
                <div class="values-grid">
                    <div class="value-box sustainable">
                        <div class="value-label">Sustainable Living</div>
                        <div class="value-number" id="currentSustainable">33.3%</div>
                    </div>
                    <div class="value-box health">
                        <div class="value-label">Health Optimization</div>
                        <div class="value-number" id="currentHealth">33.4%</div>
                    </div>
                    <div class="value-box environmental">
                        <div class="value-label">Environmental Conservation</div>
                        <div class="value-number" id="currentEnvironmental">33.3%</div>
                    </div>
                </div>
                <button class="lock-button current" id="lockCurrent">Lock In Current Values</button>
            </div>

            <!-- Future Year Plot -->
            <div class="plot-card">
                <h3 class="plot-title">Year 2075</h3>
                <div class="svg-container">
                    <svg id="futurePlot" width="560" height="506"></svg>
                </div>
                <div class="values-grid">
                    <div class="value-box sustainable">
                        <div class="value-label">Sustainable Living</div>
                        <div class="value-number" id="futureSustainable">33.3%</div>
                    </div>
                    <div class="value-box health">
                        <div class="value-label">Health Optimization</div>
                        <div class="value-number" id="futureHealth">33.4%</div>
                    </div>
                    <div class="value-box environmental">
                        <div class="value-label">Environmental Conservation</div>
                        <div class="value-number" id="futureEnvironmental">33.3%</div>
                    </div>
                </div>
                <button class="lock-button future" id="lockFuture">Lock In Future Values</button>
            </div>
        </div>

        <div class="submit-section">
            <button class="submit-button" id="submitButton" disabled>Submit Response</button>
        </div>

        <div class="thank-you-overlay" id="thankYouOverlay">
            <div class="thank-you-box">
                <div class="thank-you-emoji">üéâ</div>
                <h2 class="thank-you-title">Thank You!</h2>
                <p class="thank-you-text">Your response has been recorded.</p>
            </div>
        </div>

        <footer>
            <p>üìç Sustainable Living is at the bottom-left corner</p>
            <p>Responses are securely collected via Formspree</p>
        </footer>
    </div>

    <script>
        // Formspree endpoint for collecting survey responses
        const FORMSPREE_ENDPOINT = 'https://formspree.io/f/xanldejj';

        // State management
        const state = {
            current: { sustainable: 0.33, health: 0.34, environmental: 0.33 },
            future: { sustainable: 0.33, health: 0.34, environmental: 0.33 },
            currentLocked: false,
            futureLocked: false
        };

        const SIZE = 400;
        const PADDING = 80;
        const HEIGHT = (Math.sqrt(3) / 2) * SIZE;

        const vertices = {
            health: { x: SIZE / 2, y: 0 },
            sustainable: { x: 0, y: HEIGHT },
            environmental: { x: SIZE, y: HEIGHT }
        };

        // Coordinate conversion functions
        function ternaryToCartesian(sustainable, health, environmental) {
            const x = vertices.sustainable.x * sustainable + 
                      vertices.health.x * health + 
                      vertices.environmental.x * environmental;
            const y = vertices.sustainable.y * sustainable + 
                      vertices.health.y * health + 
                      vertices.environmental.y * environmental;
            return { x, y };
        }

        function cartesianToTernary(x, y) {
            const x1 = vertices.sustainable.x, y1 = vertices.sustainable.y;
            const x2 = vertices.environmental.x, y2 = vertices.environmental.y;
            const x3 = vertices.health.x, y3 = vertices.health.y;
            
            const det = (y2 - y3) * (x1 - x3) + (x3 - x2) * (y1 - y3);
            const sustainable = ((y2 - y3) * (x - x3) + (x3 - x2) * (y - y3)) / det;
            const environmental = ((y3 - y1) * (x - x3) + (x1 - x3) * (y - y3)) / det;
            const health = 1 - sustainable - environmental;
            
            const clampedSustainable = Math.max(0, Math.min(1, sustainable));
            const clampedHealth = Math.max(0, Math.min(1, health));
            const clampedEnvironmental = Math.max(0, Math.min(1, environmental));
            
            const sum = clampedSustainable + clampedHealth + clampedEnvironmental;
            
            return {
                sustainable: clampedSustainable / sum,
                health: clampedHealth / sum,
                environmental: clampedEnvironmental / sum
            };
        }

        // Create SVG elements
        function createTernaryPlot(svgId, title) {
            const svg = document.getElementById(svgId);
            svg.innerHTML = '';
            
            const g = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            g.setAttribute('transform', `translate(${PADDING}, ${PADDING})`);
            
            // Gradient
            const defs = document.createElementNS('http://www.w3.org/2000/svg', 'defs');
            const gradient = document.createElementNS('http://www.w3.org/2000/svg', 'linearGradient');
            gradient.setAttribute('id', `grad-${svgId}`);
            gradient.innerHTML = `
                <stop offset="0%" stop-color="#10b981" stop-opacity="0.15" />
                <stop offset="50%" stop-color="#3b82f6" stop-opacity="0.15" />
                <stop offset="100%" stop-color="#8b5cf6" stop-opacity="0.15" />
            `;
            defs.appendChild(gradient);
            g.appendChild(defs);
            
            // Triangle
            const polygon = document.createElementNS('http://www.w3.org/2000/svg', 'polygon');
            polygon.setAttribute('points', `${vertices.health.x},${vertices.health.y} ${vertices.sustainable.x},${vertices.sustainable.y} ${vertices.environmental.x},${vertices.environmental.y}`);
            polygon.setAttribute('fill', `url(#grad-${svgId})`);
            polygon.setAttribute('stroke', '#64748b');
            polygon.setAttribute('stroke-width', '3');
            g.appendChild(polygon);
            
            // Grid lines
            [0.25, 0.5, 0.75].forEach(v => {
                const sustainableLine1 = ternaryToCartesian(v, 1-v, 0);
                const sustainableLine2 = ternaryToCartesian(v, 0, 1-v);
                const healthLine1 = ternaryToCartesian(0, v, 1-v);
                const healthLine2 = ternaryToCartesian(1-v, v, 0);
                const envLine1 = ternaryToCartesian(1-v, 0, v);
                const envLine2 = ternaryToCartesian(0, 1-v, v);
                
                const lines = [
                    { x1: sustainableLine1.x, y1: sustainableLine1.y, x2: sustainableLine2.x, y2: sustainableLine2.y, color: '#3b82f6' },
                    { x1: healthLine1.x, y1: healthLine1.y, x2: healthLine2.x, y2: healthLine2.y, color: '#10b981' },
                    { x1: envLine1.x, y1: envLine1.y, x2: envLine2.x, y2: envLine2.y, color: '#8b5cf6' }
                ];
                
                lines.forEach(l => {
                    const line = document.createElementNS('http://www.w3.org/2000/svg', 'line');
                    line.setAttribute('x1', l.x1);
                    line.setAttribute('y1', l.y1);
                    line.setAttribute('x2', l.x2);
                    line.setAttribute('y2', l.y2);
                    line.setAttribute('stroke', l.color);
                    line.setAttribute('stroke-width', '1');
                    line.setAttribute('stroke-dasharray', '3,3');
                    line.setAttribute('opacity', '0.4');
                    g.appendChild(line);
                });
            });
            
            // Labels
            const labels = [
                { text: 'Health Optimization', x: vertices.health.x, y: vertices.health.y - 20, color: '#059669', anchor: 'middle' },
                { text: 'Sustainable', x: vertices.sustainable.x - 25, y: vertices.sustainable.y + 25, color: '#1e40af', anchor: 'middle' },
                { text: 'Living', x: vertices.sustainable.x - 25, y: vertices.sustainable.y + 40, color: '#1e40af', anchor: 'middle' },
                { text: 'Environmental', x: vertices.environmental.x + 35, y: vertices.environmental.y + 25, color: '#7c3aed', anchor: 'middle' },
                { text: 'Conservation', x: vertices.environmental.x + 35, y: vertices.environmental.y + 40, color: '#7c3aed', anchor: 'middle' }
            ];
            
            labels.forEach(l => {
                const text = document.createElementNS('http://www.w3.org/2000/svg', 'text');
                text.setAttribute('x', l.x);
                text.setAttribute('y', l.y);
                text.setAttribute('text-anchor', l.anchor);
                text.setAttribute('fill', l.color);
                text.setAttribute('font-weight', 'bold');
                text.setAttribute('font-size', '16');
                text.textContent = l.text;
                g.appendChild(text);
            });
            
            // Point group
            const pointGroup = document.createElementNS('http://www.w3.org/2000/svg', 'g');
            pointGroup.setAttribute('id', `${svgId}-point`);
            g.appendChild(pointGroup);
            
            svg.appendChild(g);
        }

        function updatePoint(svgId, data, isLocked) {
            const point = ternaryToCartesian(data.sustainable, data.health, data.environmental);
            const pointGroup = document.getElementById(`${svgId}-point`);
            pointGroup.innerHTML = '';
            
            if (!isLocked) {
                const pingCircle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
                pingCircle.setAttribute('cx', point.x);
                pingCircle.setAttribute('cy', point.y);
                pingCircle.setAttribute('r', '12');
                pingCircle.setAttribute('fill', '#ef4444');
                pingCircle.setAttribute('opacity', '0.3');
                pingCircle.setAttribute('class', 'ping');
                pointGroup.appendChild(pingCircle);
            }
            
            const circle = document.createElementNS('http://www.w3.org/2000/svg', 'circle');
            circle.setAttribute('cx', point.x);
            circle.setAttribute('cy', point.y);
            circle.setAttribute('r', '12');
            circle.setAttribute('fill', isLocked ? '#94a3af' : '#ef4444');
            circle.setAttribute('stroke', 'white');
            circle.setAttribute('stroke-width', '3');
            pointGroup.appendChild(circle);
        }

        function updateValues(type, data) {
            document.getElementById(`${type}Sustainable`).textContent = (data.sustainable * 100).toFixed(1) + '%';
            document.getElementById(`${type}Health`).textContent = (data.health * 100).toFixed(1) + '%';
            document.getElementById(`${type}Environmental`).textContent = (data.environmental * 100).toFixed(1) + '%';
        }

        function setupPlotInteraction(svgId, type) {
            const svg = document.getElementById(svgId);
            let isDragging = false;
            
            function handleMove(e) {
                if (state[`${type}Locked`]) return;
                
                const rect = svg.getBoundingClientRect();
                const x = e.clientX - rect.left - PADDING;
                const y = e.clientY - rect.top - PADDING;
                
                if (x >= -10 && x <= SIZE + 10 && y >= -10 && y <= HEIGHT + 10) {
                    const newData = cartesianToTernary(x, y);
                    state[type] = newData;
                    updatePoint(svgId, newData, false);
                    updateValues(type, newData);
                }
            }
            
            svg.addEventListener('mousedown', (e) => {
                if (state[`${type}Locked`]) return;
                isDragging = true;
                handleMove(e);
            });
            
            svg.addEventListener('mousemove', (e) => {
                if (isDragging) handleMove(e);
            });
            
            document.addEventListener('mouseup', () => {
                isDragging = false;
            });
        }

        function validateForm() {
            const name = document.getElementById('userName').value.trim();
            const email = document.getElementById('userEmail').value.trim();
            return name !== '' && email !== '' && email.includes('@');
        }

        function checkSubmitButton() {
            const submitButton = document.getElementById('submitButton');
            submitButton.disabled = !(state.currentLocked && state.futureLocked);
        }

        async function handleSubmit() {
            if (!state.currentLocked || !state.futureLocked) {
                alert('Please complete both ternary plots before submitting!');
                return;
            }

            if (!validateForm()) {
                document.getElementById('formError').classList.add('show');
                document.getElementById('userName').scrollIntoView({ behavior: 'smooth', block: 'center' });
                return;
            }

            document.getElementById('formError').classList.remove('show');
            
            const submitButton = document.getElementById('submitButton');
            const originalText = submitButton.textContent;
            submitButton.disabled = true;
            submitButton.innerHTML = '<span class="loading-spinner"></span> Submitting...';
            
            const formData = {
                name: document.getElementById('userName').value.trim(),
                email: document.getElementById('userEmail').value.trim(),
                comments: document.getElementById('userComments').value.trim(),
                timestamp: new Date().toISOString(),
                current_sustainable_living: (state.current.sustainable * 100).toFixed(2),
                current_health_optimization: (state.current.health * 100).toFixed(2),
                current_environmental_conservation: (state.current.environmental * 100).toFixed(2),
                future_sustainable_living: (state.future.sustainable * 100).toFixed(2),
                future_health_optimization: (state.future.health * 100).toFixed(2),
                future_environmental_conservation: (state.future.environmental * 100).toFixed(2)
            };
            
            try {
                const response = await fetch(FORMSPREE_ENDPOINT, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify(formData)
                });
                
                if (response.ok) {
                    // Show thank you message
                    document.getElementById('thankYouOverlay').classList.add('show');
                    
                    setTimeout(() => {
                        document.getElementById('thankYouOverlay').classList.remove('show');
                        
                        // Reset form and plots for next submission
                        document.getElementById('userName').value = '';
                        document.getElementById('userEmail').value = '';
                        document.getElementById('userComments').value = '';
                        
                        state.currentLocked = false;
                        state.futureLocked = false;
                        state.current = { sustainable: 0.33, health: 0.34, environmental: 0.33 };
                        state.future = { sustainable: 0.33, health: 0.34, environmental: 0.33 };
                        
                        updatePoint('currentPlot', state.current, false);
                        updatePoint('futurePlot', state.future, false);
                        updateValues('current', state.current);
                        updateValues('future', state.future);
                        
                        document.getElementById('currentPlot').classList.remove('completed');
                        document.getElementById('futurePlot').classList.remove('completed');
                        document.getElementById('lockCurrent').disabled = false;
                        document.getElementById('lockCurrent').textContent = 'Lock In Current Values';
                        document.getElementById('lockFuture').disabled = false;
                        document.getElementById('lockFuture').textContent = 'Lock In Future Values';
                        
                        submitButton.textContent = originalText;
                        checkSubmitButton();
                    }, 3000);
                } else {
                    throw new Error('Submission failed');
                }
            } catch (error) {
                alert('There was an error submitting your response. Please try again.');
                submitButton.textContent = originalText;
                submitButton.disabled = false;
            }
        }

        // Initialize
        createTernaryPlot('currentPlot', 'Present Day (2025)');
        createTernaryPlot('futurePlot', 'Year 2075');
        updatePoint('currentPlot', state.current, false);
        updatePoint('futurePlot', state.future, false);
        setupPlotInteraction('currentPlot', 'current');
        setupPlotInteraction('futurePlot', 'future');

        // Event listeners
        document.getElementById('lockCurrent').addEventListener('click', () => {
            state.currentLocked = true;
            document.getElementById('currentPlot').classList.add('completed');
            document.getElementById('lockCurrent').disabled = true;
            document.getElementById('lockCurrent').textContent = '‚úì Completed';
            updatePoint('currentPlot', state.current, true);
            checkSubmitButton();
        });

        document.getElementById('lockFuture').addEventListener('click', () => {
            state.futureLocked = true;
            document.getElementById('futurePlot').classList.add('completed');
            document.getElementById('lockFuture').disabled = true;
            document.getElementById('lockFuture').textContent = '‚úì Completed';
            updatePoint('futurePlot', state.future, true);
            checkSubmitButton();
        });

        document.getElementById('submitButton').addEventListener('click', handleSubmit);
    </script>
</body>
</html>
       

      
   
          
